<!DOCTYPE html>
<html lang="en"><head>
<script src="L10_MaximumLikelihood_files/libs/clipboard/clipboard.min.js"></script>
<script src="L10_MaximumLikelihood_files/libs/quarto-html/tabby.min.js"></script>
<script src="L10_MaximumLikelihood_files/libs/quarto-html/popper.min.js"></script>
<script src="L10_MaximumLikelihood_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="L10_MaximumLikelihood_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="L10_MaximumLikelihood_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="L10_MaximumLikelihood_files/libs/quarto-html/quarto-syntax-highlighting-07ba0ad10f5680c660e360ac31d2f3b6.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.33">

  <meta name="author" content="FW8051 Statistics for Ecologists">
  <title>Maximum Likelihood</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="L10_MaximumLikelihood_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="L10_MaximumLikelihood_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="L10_MaximumLikelihood_files/libs/revealjs/dist/theme/quarto-27a844e7d43f0d31b27642e48490372a.css">
  <link href="L10_MaximumLikelihood_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="L10_MaximumLikelihood_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="L10_MaximumLikelihood_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="L10_MaximumLikelihood_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="L10_MaximumLikelihood_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="L10_MaximumLikelihood_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Maximum Likelihood</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
FW8051 Statistics for Ecologists 
</div>
</div>
</div>

</section>
<section id="learning-objectives" class="slide level2">
<h2>Learning Objectives</h2>
<ul>
<li>Understand how to use Maximum Likelihood to estimate parameters in statistical models<br>
</li>
<li>Understand how to create confidence intervals for parameters estimated using Maximum Likelihood</li>
</ul>
<!---
## Reference material

Jack Weiss's notes:

\href{http://www.unc.edu/courses/2008fall/ecol/563/001/docs/lectures.htm}{\beamergotobutton{EcOL 653 2008 Lectures 6-7}}

- {http://www.unc.edu/courses/2008fall/ecol/563/001/docs/lectures.htm}\normalsize

\href{http://www.unc.edu/courses/2010fall/ecol/563/001/docs/lectures.html}{\beamergotobutton{EcOL 653 2010 Lecture 6-11}}

- {http://www.unc.edu/courses/2010fall/ecol/563/001/docs/lectures.html}\normalsize

--->
</section>
<section id="estimation" class="slide level2">
<h2>Estimation</h2>
<p>We’ve covered a number of statistical distributions, described by a small set of <span style="color:red;">parameters</span>.</p>
<div class="fragment">
<ul>
<li>How do we determine appropriate values of the parameters?</li>
<li>How do we incorporate the effects of covariates?</li>
</ul>
</div>
<div class="fragment">
<p>Methods of estimation:</p>
<ul>
<li>Least squares</li>
<li>Maximum likelihood</li>
<li>Bayesian methods</li>
</ul>
</div>
</section>
<section id="mle1" class="slide level2" data-menu-title="Slugs">
<h2></h2>
<p>Example from Crawley 2002. Statistical Computing and also his The R Book (2007).</p>

<img data-src="Graphics/slugs.jpg" class="quarto-figure quarto-figure-center r-stretch" alt="Picture of a slug!" width="200"><ul>
<li>Counted slugs in 2 fields (rookery, nursery)</li>
<li>40 observations in each</li>
</ul>
</section>
<section id="barplot" class="slide level2">
<h2>Barplot</h2>
<div class="cell" data-layout-align="center" data-fit-alt="Distribution of slug counts under tiles placed in two fields is right skewed with most counts being 0, 1, 2, or 3 slugs per tile.">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r fold-hide code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(slugs, <span class="fu">aes</span>(slugs, <span class="at">fill=</span>field))<span class="sc">+</span></span>
<span id="cb1-2"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position=</span><span class="fu">position_dodge</span>())<span class="sc">+</span></span>
<span id="cb1-3"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>))<span class="sc">+</span></span>
<span id="cb1-4"><a href="" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>))<span class="sc">+</span></span>
<span id="cb1-5"><a href="" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">11</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="L10_MaximumLikelihood_files/figure-revealjs/unnamed-chunk-5-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:70.0%"></section>
<section id="hypothesis-test" class="slide level2" style="font-size: 80%;">
<h2>Hypothesis test</h2>
<p>What if we want to use a t-test to test <span class="math inline">\(H_0: \mu_{rookery} = \mu_{nursery}\)</span>? What do we have to assume?</p>
<div class="fragment">
<ul>
<li>The data are normally distributed or sample size is “large enough” for the CLT to apply</li>
</ul>
</div>
<div class="fragment">
<p>Are these assumptions reasonable in light of:</p>
<ul>
<li>We have counts (discrete data)</li>
<li>There were 40 tiles in each of the 2 grasslands (field, nursery)</li>
</ul>
</div>
<div class="fragment">
<p>…maybe (<span class="math inline">\(n = 30\)</span> is a common rule for CLT to apply)</p>
</div>
<div class="fragment">
<p>Also, side note, is this an interesting hypothesis to test?</p>
</div>
</section>
<section id="alternative-statistical-distributions" class="slide level2" style="font-size: 80%;">
<h2>Alternative Statistical Distributions</h2>
<p>Are there other, more appropriate statistical distributions we could use (instead of Gaussian)?</p>
<div class="fragment">
<p><em>Given that we have count data, we might consider a Poisson or Negative Binomial distribution for the data</em></p>
</div>
<div class="fragment">
<p>We could assume:</p>
<ul>
<li>Nursery <span class="math inline">\(\sim Poisson(\lambda_1)\)</span></li>
<li>Rookery <span class="math inline">\(\sim Poisson(\lambda_2)\)</span></li>
</ul>
</div>
<div class="fragment">
<p>Test whether <span class="math inline">\(\lambda_1 = \lambda_2\)</span></p>
</div>
<div class="fragment">
<p>How would we estimate the parameters?</p>
</div>
<div class="fragment">
<p>Lets start with the simper case of <span class="math inline">\(Y_i \sim Poisson(\lambda)\)</span> (ignoring field type)</p>
</div>
</section>
<section id="maximum-likelihood" class="slide level2" style="font-size: 80%;">
<h2>Maximum Likelihood</h2>
<p>Start by writing down a probability statement regarding the data.</p>
<div class="fragment">
<p>Consider the first data point from the Nursery (3 slugs):</p>
</div>
<div class="fragment">
<p><span class="math inline">\(P(X = 3) = \frac{\exp(-\lambda )(\lambda)^3}{3!}\)</span> if the counts are Poisson distributed</p>
</div>
<div class="fragment">
<p>or</p>
<p><span class="math inline">\(P(X = 3) = {3+\theta-1 \choose 3}\left(\frac{\theta}{\mu+\theta}\right)^{\theta}\left(\frac{\mu}{\mu+\theta}\right)^3\)</span> if NegBinomial</p>
</div>
<div class="fragment">
<p>What about the other observations?</p>
</div>
</section>
<section id="constructing-the-likelihood" class="slide level2 smaller">
<h2>Constructing the Likelihood</h2>
<p>Assume the data come from a random sample, and that the points are <span style="color:red;">independent</span>. Then:</p>
<div class="fragment">
<p><span class="math inline">\(P(X_1\)</span> =3 &amp; <span class="math inline">\(X_2 = 0\)</span> &amp; <span class="math inline">\(\cdots X_{40}=4)\)</span> = <span class="math inline">\(P(X_1=3)P(X_2=0)\cdots P(X_{40}=4)\)</span></p>
</div>
<div class="fragment">
<p>= <span class="math inline">\(\frac{\exp(-\lambda )(\lambda)^3}{3!}\frac{\exp(-\lambda )(\lambda)^0}{0!}\cdots \frac{\exp(-\lambda )(\lambda)^4}{4!}\)</span></p>
</div>
</section>
<section id="more-generally" class="slide level2 smaller">
<h2>More Generally</h2>
<p>We obtain a random sample of <span class="math inline">\(n\)</span> observations from some statistical distribution.</p>
<div class="fragment">
<p>Write down the probability of obtaining the data:</p>
<p><span class="math inline">\(P(X_1 =x_1, X_2=x_2, \ldots, X_n = x_n)\)</span> = <span class="math inline">\(P(X_1=x_1)P(X_2=x_2)\cdots P(X_n=x_n)\)</span></p>
</div>
<div class="fragment">
<p>= <span class="math inline">\(\prod_{i=1}^n P(X_i = x_i)\)</span></p>
</div>
<div class="fragment">
<p>For the Poisson distribution:</p>
<p><span class="math display">\[L(\lambda; x_1, x_2, \ldots, x_n) = \prod_{i=1}^n\frac{\lambda^{x_i}\exp(-\lambda)}{x_i!}\]</span></p>
<p><span class="math display">\[=\frac{\exp(-\lambda )(\lambda)^{x_1}}{X_1!}\frac{\exp(-\lambda)(\lambda)^{x_2}}{x_2!}\cdots \frac{\exp(-\lambda )(\lambda)^{x_n}}{x_n!}\]</span></p>
</div>
<div class="fragment">
<p><span class="math display">\[=\frac{\exp(-n\lambda)(\lambda)^{\sum_{i=1}^nx_i}}{x_1!x_2!\cdots x_n!}\]</span></p>
</div>
<div class="fragment">
<p>This gives us the <span style="color:red;">Likelihood</span> of the data!</p>
</div>
</section>
<section id="likelihood" class="slide level2 smaller">
<h2>Likelihood</h2>
<p>For discrete distributions, the <span style="color:red;">likelihood</span> gives us the probability of obtaining the observed data for a particular set of parameters (in this case, <span class="math inline">\(\lambda\)</span>).</p>
<div class="fragment">
<p><span class="math display">\[P(data; \lambda) = \frac{\exp(-n\lambda)(\lambda)^{\sum_{i=1}^nx_i}}{x_1!x_2!\cdots x_n!} = L(\lambda; data)\]</span></p>
</div>
<div class="fragment">
<p>P(data; parameter):</p>
<ul>
<li>Views the data as random, the parameter as fixed.</li>
</ul>
</div>
<div class="fragment">
<p>Likelihood(parameters; data):</p>
<ul>
<li>Conditions on the data and considers probability as a function of the parameter.</li>
</ul>
</div>
<div class="fragment">
<p>The <span style="color:red;">maximum likelihood estimate</span> is the value of the parameter, <span class="math inline">\(\lambda\)</span>, that maximizes the likelihood (<em>makes the the observed data most likely</em>)</p>
</div>
</section>
<section id="maximum-likelhood" class="slide level2">
<h2>Maximum Likelhood</h2>
<p>The <span style="color:red;">maximum likelihood estimate</span> is the value of the parameter, <span class="math inline">\(\lambda\)</span>, that (i.e., maximizes the likelihood)</p>
<div class="fragment">
<p><span class="math display">\[L(\lambda; x_1, x_2, \ldots, x_n) = \prod_{i=1}^n\frac{\lambda^{x_i}\exp(-\lambda)}{x_i!}\]</span></p>
</div>
<div class="fragment">
<p>How can we find the value of <span class="math inline">\(\lambda\)</span> that maximizes <span class="math inline">\(L(\lambda; x_1, x_2, \ldots, x_n)\)</span>?</p>
</div>
<div class="fragment">
<p>Calculus (take derivatives with respect to <span class="math inline">\(\lambda\)</span> and set = 0).</p>
</div>
</section>
<section id="log-likelihood" class="slide level2 smaller">
<h2>Log-likelihood</h2>
<p>For practical and theoretical reasons, we usually work with the <span style="color:red;">log-likelihood</span> (maximizing the log-likelihood is equivalent to maximizing the likelihood)</p>
<p><span class="math display">\[logL(\lambda; x_1, x_2, \ldots, x_n)= log(L(\lambda; x_1, x_2, \ldots, x_n)) = \log(\prod_{i=1}^n P(X_i = x_i))\]</span></p>
<div class="fragment">
<p><span class="math inline">\(= \sum_{i=1}^n log(P(X_i = x_i))\)</span></p>
</div>
<div class="fragment">
<p>For the Poisson model:</p>
<p><span class="math inline">\(logL(\lambda; x_1, x_2, \ldots, x_n) = -n\lambda +\log(\lambda)\sum_{i=1}^n X_i - \sum_{i=1}^n \log(x_i!)\)</span></p>
</div>
<div class="fragment">
<p>To <span style="color:red;">maximize</span>, take derivatives and set the expression = 0, giving: …</p>
<p><span class="math display">\[-n + \frac{\sum_{i=1}^n X_i}{\lambda} = 0\]</span></p>
<p><span class="math display">\[\Rightarrow \hat{\lambda}=\sum_{i=1}^n \frac{X_i}{n}\]</span></p>
</div>
</section>
<section id="some-notes" class="slide level2" style="font-size: 80%;">
<h2>Some notes</h2>
<p>To verify that <span class="math inline">\(\hat{\lambda}\)</span> maximizes (rather than minimizes) <span class="math inline">\(logL(\lambda| x)\)</span>:</p>
<ul>
<li>Verify that the <span class="math inline">\(\frac{\partial^2 logL(\lambda; x)}{\partial \lambda^2}\)</span> evaluated at <span class="math inline">\(\lambda = \hat{\lambda} =\bar{x} &lt; 0\)</span></li>
</ul>
<div class="fragment">
<p>Note: If <span class="math inline">\(X \sim\)</span> Poisson(<span class="math inline">\(\lambda\)</span>), <span class="math inline">\(E[X] = \lambda\)</span></p>
<ul>
<li>It makes sense to estimate <span class="math inline">\(\lambda\)</span> by the sample mean!</li>
</ul>
</div>
<div class="fragment">
<p>Some constants, e.g., <span class="math inline">\(\sum_{i=1}^n \log(x_i!)\)</span> do not matter when maximizing the likelihood</p>
<ul>
<li>Statistical software may drop/ignore these</li>
<li>Can matter when comparing models for different probability distributions using AIC</li>
</ul>
</div>
</section>
<section id="finding-the-best-value-of-lambda" class="slide level2">
<h2>Finding the “best” value of <span class="math inline">\(\lambda\)</span></h2>
<p>What if we do not remember calculus? How can we find the value of <span class="math inline">\(\lambda\)</span> that maximizes:</p>
<p><span class="math display">\[L(\lambda; x_1, x_2, \ldots, x_n) = \prod_{i=1}^n\frac{\lambda^{x_i}\exp(-\lambda)}{x_i!}\]</span></p>
<div class="fragment">
<p>Graph this expression for different values of <span class="math inline">\(\lambda\)</span></p>
<p>[Excel in-class exercise]</p>
</div>
</section>
<section id="finding-the-best-values-for-lambda_1-and-lambda_2" class="slide level2" style="font-size: 80%;">
<h2>Finding the “best” values for <span class="math inline">\(\lambda_1\)</span> and <span class="math inline">\(\lambda_2\)</span></h2>
<p>What if we had a function of more than 1 parameter? How could we numerically find the value of <span class="math inline">\(\lambda\)</span> that maximizes:</p>
<p><span class="math display">\[L(\lambda_1, \lambda_2; x_1, x_2, \ldots, x_n) = \prod_{i=1}^{n_{field}}\frac{\lambda_1^{x_i}\exp(-\lambda_{1})}{x_i!} \prod_{j=1}^{n_{rookery}}\frac{\lambda_2^{x_j}\exp(-\lambda_{2})}{x_j!}\]</span></p>
<p>Use <em>solver</em> in Excel or <code>optim</code> (or <code>glm</code>) in R</p>
<p>[In-class exercise R]</p>
</section>
<section id="optim" class="slide level2" style="font-size: 80%;">
<h2>Optim?</h2>
<p>Tadpole predation: Example 6.3.1.1 from Bolker et al.(2008)<sup>1</sup></p>
<p><span class="math display">\[p = \frac{a}{1+ahN}\]</span></p>
<p><span class="math display">\[k \sim Binomial(p,N)\]</span></p>
<ul>
<li><span class="math inline">\(N\)</span> = number of tadpoles in a tank</li>
<li><span class="math inline">\(k\)</span> = number eaten by predators</li>
</ul>
<div class="fragment">
<p>We will come back to this or a similar example (in this section and later after introducing Bayesian methods).</p>
</div>
<aside><ol class="aside-footnotes"><li id="fn1"><p>Bolker, B.M. 2008. Ecological Models and Data in R. Princeton University Press, Oxford, UK.</p></li></ol></aside></section>
<section id="properties-of-maximum-likelihood-estimators" class="slide level2" style="font-size: 80%;">
<h2>Properties of Maximum Likelihood Estimators</h2>
<p><span class="math inline">\(\hat{\theta}\)</span> = maximum likelihood estimate of <span class="math inline">\(\theta\)</span>.</p>
<p>For large <span class="math inline">\(n\)</span> (asymptotically):</p>
<div class="fragment">
<ul>
<li>Maximum likelihood estimators are unbiased<sup>1</sup></li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Have minimum variance among estimators</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Will be normally distributed: <span class="math inline">\(\hat{\theta} \sim N(\theta, I^{-1}(\theta))\)</span></li>
</ul>
</div>
<div class="fragment">
<p><span class="math inline">\(I(\theta)\)</span> is called the <span style="color:red;">Information matrix</span></p>
</div>
<aside><ol class="aside-footnotes"><li id="fn2"><p>Not always true for small <span class="math inline">\(n\)</span>. For example, <span class="math inline">\(\sigma^2_{MLE} = \sum (x_i-\mu)^2/n\)</span> (biased by a factor of <span class="math inline">\(n/(n-1)\)</span>)</p></li></ol></aside></section>
<section id="information-matrix" class="slide level2" style="font-size: 80%;">
<h2>Information Matrix</h2>
<p><span style="color:red;">Observed information matrix</span>, observed <span class="math inline">\(I(\theta)\)</span> = <span class="math inline">\(-\frac{\partial^2 logL(\theta)}{\partial \theta^2}\)</span> evaluated at <span class="math inline">\(\theta = \hat{\theta}\)</span></p>
<div class="fragment">
<p><span style="color:red;">Estimated information matrix</span>, expected <span class="math inline">\(I(\theta)\)</span> = <span class="math inline">\(E\left(-\frac{\partial^2 logL(\theta)}{\partial \theta^2}\right)\)</span> evaluated at <span class="math inline">\(\theta = \hat{\theta}\)</span></p>
</div>
<div class="fragment">
<p>The matrix of second derivatives of logL with respect to <span class="math inline">\(\theta\)</span> is called the <span style="color:red;">Hessian</span>:</p>
<p>Hessian(<span class="math inline">\(\theta) = \left[\frac{\partial^2 logL(\theta)}{\partial \theta^2}\right]\)</span></p>
</div>
</section>
<section id="observed-information-matrix" class="slide level2">
<h2>Observed Information Matrix</h2>
<ul>
<li>Used to numerically maximize functions (get for “free”) (note: typically we <em>minimize</em> -logL rather than maximize logL, so the minus sign is already included)</li>
</ul>
<div class="fragment">
<ul>
<li>Inverse of observed information matrix is usually what is reported as <span class="math inline">\(var(\hat{\theta})\)</span> by statistical software</li>
</ul>
</div>
</section>
<section id="hessian" class="slide level2 smaller">
<h2>Hessian</h2>
<div class="columns">
<div class="column" style="width:75%;">
<p>The Hessian(<span class="math inline">\(\theta\)</span>) = <span class="math inline">\(\left[\frac{\partial^2 logL(\theta)}{\partial \theta^2}\right]\)</span> describes curvature in the log-likelihood curve (surface). If <span class="math inline">\(\left[\frac{\partial^2 logL(\theta)}{\partial \theta^2}\right]\)</span> is close to 0:</p>
<div>
<ul>
<li class="fragment">The likelihood surface is flat</li>
<li class="fragment">LogL is similar across a range of parameter values</li>
</ul>
</div>
</div><div class="column" style="width:25%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Graphics/hess.jpg" class="quarto-figure quarto-figure-center" style="width:100.0%" alt="Picture of 3 log-likelihoods with varying levels of curvature."></p>
</figure>
</div>
</div>
</div>
</div></div>
<div class="fragment">
<p>Leads to larger confidence intervals since <span class="math inline">\(\widehat{var}(\hat{\theta}) = I^{-1}(\theta) =\)</span> Hessian<span class="math inline">\(^{-1}(\theta)\)</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Graphics/hess2.jpg" class="quarto-figure quarto-figure-center" style="width:70.0%" alt="Table relating curvature to information content, variance of the parameter, and width of the confidence interval.  When the Hessian has high curvature, information content is high, variance is low, and confidence intervals will be narrow."></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="likelihood-ratio-test" class="slide level2" style="font-size: 80%;">
<h2>Likelihood Ratio Test</h2>
<p>A <span style="color:red;">likelihood ratio test</span> can be used to test nested models with:</p>
<ul>
<li>The same probability generating mechanism (i.e., same statistical distribution)</li>
<li>All of the same parameters, except that in one model some parameters are set to specific values (typically 0)</li>
</ul>
<div class="fragment">
<p>Slug data example:</p>
<div class="columns">
<div class="column" style="width:50%;">
<p>Full model:</p>
<ul>
<li><span class="math inline">\(Y_i |\)</span> Nursery <span class="math inline">\(\sim Poisson(\lambda_1)\)</span></li>
<li><span class="math inline">\(Y_i |\)</span> Rookery <span class="math inline">\(\sim Poisson(\lambda_2)\)</span></li>
</ul>
</div><div class="column" style="width:50%;">
<p>Reduced model:</p>
<ul>
<li><span class="math inline">\(Y_i \sim Poisson(\lambda)\)</span> (i.e., <span class="math inline">\(\lambda_2= \lambda_1\)</span>)</li>
</ul>
</div></div>
</div>
</section>
<section id="likelihood-ratio-test-1" class="slide level2" style="font-size: 80%;">
<h2>Likelihood Ratio Test</h2>
<p>Test statistic:</p>
<p><span class="math display">\[LR  = 2log\left[\frac{L(\lambda_1, \lambda_2 | Y)}{L(\lambda | Y)}\right] = 2[logL(\lambda_1, \lambda_2 | Y)-logL(\lambda | Y)]\]</span></p>
<div class="fragment">
<p>Null distribution (appropriate when <span class="math inline">\(n\)</span> is large):</p>
<p><span class="math display">\[LR \sim \chi^2_1\]</span></p>
</div>
<div class="fragment">
<p>and more generally <span class="math inline">\(\chi^2_p\)</span>, where <span class="math inline">\(p\)</span> is the difference in the number of parameters in the two models (See Section 10.9 in book).</p>
</div>
</section>
<section id="profile-likelihood-cis" class="slide level2 smaller">
<h2>Profile Likelihood CIs</h2>
<p>Can “invert” the LR test to get <span style="color:red;">profile likelihood-based confidence intervals</span>. Consider generating a CI for <span class="math inline">\(\lambda\)</span> under the common <span class="math inline">\(\lambda\)</span> model.</p>
<p>We could use the <span style="color:red;">likelihood ratio test</span> to evaluate <span class="math inline">\(H_0: \lambda = \lambda_0\)</span> vs.&nbsp;<span class="math inline">\(H_A: \lambda \ne \lambda_0\)</span>:</p>
<p><span class="math display">\[LR  = 2log\left[\frac{L(\hat{\lambda} | Y)}{L(\lambda_0 | Y)}\right] \sim \chi^2_1\]</span></p>
<p>where <span class="math inline">\(\hat{\lambda}\)</span> is the MLE of <span class="math inline">\(\lambda\)</span>.</p>
<div class="fragment">
<ul>
<li>Reject <span class="math inline">\(\lambda = \lambda_0\)</span> at <span class="math inline">\(\alpha=0.05\)</span> if LR <span class="math inline">\(&gt;\chi^2_1(0.95)\)</span>, where <span class="math inline">\(\chi^2_1(0.95)\)</span> is the 95% of the <span class="math inline">\(\chi^2_1\)</span> distribution.</li>
<li>Fail to reject if LR <span class="math inline">\(&lt;\chi^2_1(0.95)\)</span> (these values are plausible, given the data)</li>
</ul>
<p>CI for <span class="math inline">\(\lambda\)</span>: include all values for which we do not reject the null hypothesis</p>
</div>
</section>
<section id="profile-likelihood-intervals" class="slide level2">
<h2>Profile Likelihood Intervals</h2>
<p>So, include in our CI all values of <span class="math inline">\(\lambda\)</span> that lie within <span class="math inline">\(\chi^2_{1}(0.95)=\)</span> <code>qchisq(alpha, df=1)/2</code> = 1.92 units of the maximum.</p>

<img data-src="Graphics/lrconf2-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:70.0%" alt="Picture of log-likelihood and cutpoints used to determine the profile likelihood interval."></section>
<section id="profile-likelihood-intervals-1" class="slide level2">
<h2>Profile Likelihood Intervals</h2>
<ul>
<li>Can extend to multi-parameter models</li>
<li>Typically more accurate than normal-based CIs (<span style="color:red;">Wald intervals</span>) when <span class="math inline">\(n\)</span> is small.</li>
</ul>
<p>See Chapter 6 in Bolker’s book (listed in <strong>Readings</strong> section on Canvas).</p>
</section>
<section id="least-squares-and-mle" class="slide level2 smaller">
<h2>Least Squares and MLE</h2>
<p>For Normally distributed data:</p>
<p><span class="math inline">\(L(\mu, \sigma^2; y_1, y_2, \ldots, y_n) = \prod_{i=1}^n \frac{1}{\sqrt{2\pi}\sigma}\exp\left(-\frac{(y_i-\mu)^2}{2\sigma^2}\right)\)</span></p>
<p><br></p>
<div class="fragment">
<p>With linear regression, we assume <span class="math inline">\(Y_i \sim N(\beta_0 + x_i\beta_1, \sigma^2)\)</span>, so…</p>
<p><span class="math inline">\(L(\beta_0, \beta_1, \sigma; x) = \prod_{i=1}^n \frac{1}{\sqrt{2\pi}\sigma}\exp\left(-\frac{(y_i-\beta_0+x_i\beta_1)^2}{2\sigma^2}\right) =\frac{1}{(\sqrt{2\pi}\sigma)^n}\exp\left(-\sum_{i=1}^n\frac{(y_i-\beta_0+x_i\beta_1)^2}{2\sigma^2}\right)\)</span></p>
</div>
<div class="fragment">
<p><span class="math inline">\(\Rightarrow logL =-nlog(\sigma) - \frac{n}{2}log(2\pi) -\sum_{i=1}^n\frac{(y_i-\beta_0+x_i\beta_1)^2}{2\sigma^2}\)</span></p>
</div>
<div class="fragment">
<p><span class="math inline">\(\Rightarrow\)</span> maximizing logL <span class="math inline">\(\Rightarrow\)</span> minimizing <span class="math inline">\(\sum_{i=1}^n\frac{(y_i-\beta_0+x_i\beta_1)^2}{2\sigma^2}\)</span></p>
<p>or, equivalently <span class="math inline">\(\sum_{i=1}^n(y_i-\beta_0-x_i\beta_1)^2\)</span></p>

</div>
</section>

    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="L10_MaximumLikelihood_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="L10_MaximumLikelihood_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="L10_MaximumLikelihood_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="L10_MaximumLikelihood_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="L10_MaximumLikelihood_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="L10_MaximumLikelihood_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="L10_MaximumLikelihood_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="L10_MaximumLikelihood_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="L10_MaximumLikelihood_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="L10_MaximumLikelihood_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="L10_MaximumLikelihood_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 5.0e-2,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    

    <script>

      // htmlwidgets need to know to resize themselves when slides are shown/hidden.

      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

      // slide changes (different for each slide format).

      (function () {

        // dispatch for htmlwidgets

        function fireSlideEnter() {

          const event = window.document.createEvent("Event");

          event.initEvent("slideenter", true, true);

          window.document.dispatchEvent(event);

        }

    

        function fireSlideChanged(previousSlide, currentSlide) {

          fireSlideEnter();

    

          // dispatch for shiny

          if (window.jQuery) {

            if (previousSlide) {

              window.jQuery(previousSlide).trigger("hidden");

            }

            if (currentSlide) {

              window.jQuery(currentSlide).trigger("shown");

            }

          }

        }

    

        // hookup for slidy

        if (window.w3c_slidy) {

          window.w3c_slidy.add_observer(function (slide_num) {

            // slide_num starts at position 1

            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

          });

        }

    

      })();

    </script>

    

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>