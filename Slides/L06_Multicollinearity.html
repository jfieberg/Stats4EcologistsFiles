<!DOCTYPE html>
<html lang="en"><head>
<script src="L06_Multicollinearity_files/libs/clipboard/clipboard.min.js"></script>
<script src="L06_Multicollinearity_files/libs/quarto-html/tabby.min.js"></script>
<script src="L06_Multicollinearity_files/libs/quarto-html/popper.min.js"></script>
<script src="L06_Multicollinearity_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="L06_Multicollinearity_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="L06_Multicollinearity_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="L06_Multicollinearity_files/libs/quarto-html/quarto-syntax-highlighting-07ba0ad10f5680c660e360ac31d2f3b6.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.33">

  <meta name="author" content="FW8051 Statistics for Ecologists">
  <title>Understanding and Dealing with Collinearity</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="L06_Multicollinearity_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="L06_Multicollinearity_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="L06_Multicollinearity_files/libs/revealjs/dist/theme/quarto-27a844e7d43f0d31b27642e48490372a.css">
  <link href="L06_Multicollinearity_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="L06_Multicollinearity_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="L06_Multicollinearity_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="L06_Multicollinearity_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="L06_Multicollinearity_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="L06_Multicollinearity_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Understanding and Dealing with Collinearity</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
FW8051 Statistics for Ecologists 
</div>
</div>
</div>

</section>
<section id="learning-objectives-collinearity" class="slide level2">
<h2>Learning Objectives: Collinearity</h2>
<ul>
<li>What is collinearity/multicollinearity?</li>
<li>How does one assess collinearity?</li>
<li>What are the different types of collinearity?</li>
<li>What are the effects of collinearity on
<ul>
<li>Parameter estimates</li>
<li>Standard errors</li>
</ul></li>
</ul>
<div class="fragment">
<p>Will draw from:</p>
<ul>
<li>A lecture by Todd Steury, Auburn University</li>
</ul>
<!--- From chatGPT:
Multicollinearity refers to a high correlation between independent variables in a regression model. This can result in unstable and unreliable regression coefficients, making it difficult to determine the true effect of each variable on the dependent variable.

Strategies for dealing with multicollinearity include:

Removing one or more highly correlated variables.

Combining highly correlated variables into a single composite variable.

Regularization techniques such as Ridge Regression or Lasso Regression, which add a penalty term to the regression coefficients to reduce their magnitude.

Dimension reduction techniques such as principal component analysis (PCA) that transform the correlated variables into a set of uncorrelated variables (principal components) that can be used in the regression analysis.

Using variable selection methods such as stepwise regression that only include a subset of the variables in the model.

It's important to note that the choice of strategy depends on the specific research question, the sample size, and the nature of the variables involved.--->
</div>
</section>
<section id="what-is-collinearity" class="slide level2">
<h2>What is Collinearity?</h2>
<p><span style="color:red;">Collinearity</span> - when one predictor variable is correlated with another predictor variable.</p>
<p><span style="color:red;">Multicollinearity</span> - when multiple predictor variables are correlated with each other.</p>
<div class="fragment">
<p><br></p>
<p>Multicollinearity implies one of the explanatory variables can be predicted by the others with a high degree of accuracy.</p>
</div>
</section>
<section id="different-types-of-collinearity" class="slide level2" style="font-size: 80%;">
<h2>Different Types of Collinearity</h2>
<ul>
<li><p><span style="color:red;">Intrinsic collinearity</span>: multiple variables measure the same inherent quantity</p>
<ul>
<li>Various morphometric measurements (all capture “size”)</li>
</ul></li>
</ul>
<div class="fragment">
<ul>
<li><p><span style="color:red;">Compositional variables</span>: have to sum to 1 (the last category is completely determined by the others)</p>
<ul>
<li>e.g., percent cover of different habitat types.</li>
</ul></li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span style="color:red;">Structural collinearity</span>: occurs when variables are measured on very different scales (e.g., <span class="math inline">\(X\)</span>, <span class="math inline">\(X^2\)</span>)</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span style="color:red;">Incidental collinearity</span>: variables may have separate effects but happen to covary in the data set possibly due to small sample sizes</li>
</ul>
</div>
</section>
<section id="examples-of-collinearity" class="slide level2">
<h2>Examples of Collinearity</h2>
<ul>
<li>Habitat attributes: riparian areas also tend to have thick understory cover<br>
</li>
<li>Urban areas have lots of impervious surface, minimal forest cover, high density of humans<br>
</li>
<li>Areas farther north tend to be colder, get more snow, less sunlight in winter.</li>
</ul>
<p>[Think-pair-share] Do you have similar examples from your study systems?</p>
</section>
<section id="symptoms-of-collinearity" class="slide level2" style="font-size: 80%;">
<h2>Symptoms of Collinearity</h2>
<ul>
<li>Variables may be significant in simple linear regression, but not in multiple regression</li>
</ul>
<div class="fragment">
<ul>
<li>Large standard errors in multiple regression models despite large sample sizes/high power</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Variables may not be significant in multiple regression, but multiple regression model (as whole) is significant (e.g., using the F-test at the bottom of regression output)</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Large changes in coefficient estimates between full and reduced models</li>
</ul>
</div>
</section>
<section id="symptoms-of-collinearity-1" class="slide level2">
<h2>Symptoms of Collinearity</h2>
<p>Interpretation of <span class="math inline">\(\beta\)</span> in a multiple regression:</p>
<ul>
<li>Expected change in <span class="math inline">\(Y\)</span> as we change <span class="math inline">\(X\)</span> by 1 unit, while holding all other predictor variables constant.</li>
</ul>
<div class="fragment">
<ul>
<li>When predictors are collinear, changes in <span class="math inline">\(X\)</span> tend to occur with changes in other variables too (making <span class="math inline">\(\beta\)</span> hard to estimate)</li>
</ul>
</div>
</section>
<section id="variance-inflation-factors" class="slide level2" style="font-size: 80%;">
<h2>Variance Inflation Factors</h2>
<p>Multicollinearity can be measured using a <span style="color:red;">variance inflation factor</span> (VIF)</p>
<p><span class="math inline">\(VIF(\hat{\beta}_j) = \frac{1}{1-R^2_{x_j|x_1, ..., x_{j-1}, x_{j+1}, x_p}}\)</span>, where</p>
<p><br></p>
<p><span class="math inline">\(R^2_{x_j|x_1, ..., x_{j-1}, x_{j+1}, x_p}\)</span> = multiple <span class="math inline">\(R^2\)</span> from:</p>
<p>lm(<span class="math inline">\(x_j \sim x_1 +  \ldots +  x_{j-1} +  x_{j+1} + x_p\)</span>)</p>
<div class="fragment">
<p>Calculate in R: <code>vif</code> in the <code>car</code> package</p>
</div>
<div class="fragment">
<p>Rules of Thumb in Published Literature:</p>
<ul>
<li>Many suggest VIFs <span class="math inline">\(\ge 10\)</span> are problematic</li>
<li>Graham (2003): VIFs as small as 2 can have significant impacts</li>
</ul>
</div>
</section>
<section id="simulation-study-confounding-variables" class="slide level2" style="font-size: 80%;">
<h2>Simulation study: Confounding Variables</h2>
<p>Truth:</p>
<ul>
<li><span class="math inline">\(Y_i = 10 + 3X_{1,i} + 3X_{2,i} + \epsilon_i\)</span> with <span class="math inline">\(\epsilon_i \sim N(0,2)\)</span></li>
<li><span class="math inline">\(X_{1,i} \sim U(0,10)\)</span></li>
<li><span class="math inline">\(X_{2,i} =\tau X_{1,i} + \gamma_i\)</span> with <span class="math inline">\(\gamma_i \sim N(0, 4)\)</span></li>
<li>Varied <span class="math inline">\(\tau\)</span> from 0 to 9 by 3 (<code>tau &lt;- seq(0,9,3)</code>)</li>
</ul>
<div class="fragment">
<p>Simulated 2000 data sets and to each fit:</p>
<ul>
<li><code>lm(Y ~ X1)</code></li>
<li><code>lm(Y ~ X1+X2)</code></li>
</ul>
</div>
</section>
<section id="section" class="slide level2" style="font-size: 80%;">
<h2></h2>

<img data-src="Graphics/confound-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:80.0%" alt="Coefficients for x1 in a model with (rigth panel) and without (left panel) x2 for different values of tau, which impacts the correlation between x1 and x2.  As tau increases, the estimated coeffcient for x1 increases when x2 is not in the model.  When x2 is included in the model, the coefficient for x1 does not change, on average, but it varies much more across data sets."><ul>
<li>coefficient for <span class="math inline">\(X_1\)</span> is biased when <span class="math inline">\(X_2\)</span> is not included (unless <span class="math inline">\(\tau=0\)</span>)</li>
<li>magnitude of the bias increases with the correlation between <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> (i.e., with <span class="math inline">\(\tau\)</span>)</li>
</ul>
<div class="fragment">
<ul>
<li>coefficient for <span class="math inline">\(X_1\)</span> is unbiased when <span class="math inline">\(X_2\)</span> is included, but SE increases when <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> are highly correlated</li>
</ul>
</div>
</section>
<section id="mathematically" class="slide level2">
<h2>Mathematically…</h2>
<p><span class="math display">\[Y_i = 10 + 3X_{1,i} + 3X_{2,i} + \epsilon_i \text{ and } X_{2,i} =\tau X_{1,i} + \gamma_i\]</span></p>
<p><br></p>
<div class="fragment">
<p><span class="math display">\[Y_i = 10 + 3X_{1,i} + 3(\tau X_{1,i} + \gamma_i) + \epsilon_i\]</span></p>
</div>
<div class="fragment">
<p><br></p>
<p><span class="math display">\[Y_i = 10 + (3+3\tau)X_{1,i} + (3\gamma_i + \epsilon_i)\]</span></p>
</div>
</section>
<section id="causal-networks" class="slide level2" style="font-size: 80%;">
<h2>Causal Networks</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Graphics/ConfoundingSim.jpg" class="quarto-figure quarto-figure-center" style="width:100.0%" alt="Directed acyclical graph (DAG) depicting causal relationships between X1, X2, and Y. There is an arrow from x2 to y, from x1 to y, and from x1 to x2."></p>
</figure>
</div>
</div>
</div>
</div><div class="column increment" style="width:50%;">
<ul>
<li><span class="math inline">\(X_1\)</span> captures the effect of both <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> when <span class="math inline">\(X_2\)</span> is left out of the model!</li>
</ul>
<p><br></p>
<ul>
<li>When we leave <span class="math inline">\(X_2\)</span> out of the model, the coefficient for <span class="math inline">\(X_1\)</span> captures the direct of effect of <span class="math inline">\(X_1\)</span> on <span class="math inline">\(Y\)</span> and also the indirect effect of <span class="math inline">\(X_1\)</span> on <span class="math inline">\(Y\)</span> (mediated by <span class="math inline">\(X_2\)</span>)<br>
</li>
</ul>
</div></div>
</section>
<section id="trade-offs" class="slide level2">
<h2>Trade-offs</h2>
<p>Models with collinear variables</p>
<ul>
<li>Large standard errors</li>
</ul>
<div class="fragment">
<p>Models in which confounding variables are left out</p>
<ul>
<li>Misleading estimates of effect due to omission of important variables</li>
</ul>
</div>
<div class="fragment">
<p>When possible, try to eliminate confounding variables via study design (e.g., experiments, matching)</p>
</div>
</section>
<section id="strategies-for-dealing-with-multicollinearity" class="slide level2" style="font-size: 80%;">
<h2>Strategies for dealing with multicollinearity</h2>
<p>If the only goal is prediction, may choose to ignore multicollinearity</p>
<ul>
<li>Often has minimal impact on prediction error (versus SEs for individual coefficients)</li>
<li>Can be problematic if making out-of-sample predictions where the extent and nature of collinearity changes</li>
</ul>
<div class="fragment">
<p>For estimation, there are methods that introduce some bias to improve precision</p>
<ul>
<li>Ridge regression, LASSO (ch 8)</li>
</ul>
</div>
</section>
<section id="other-methods" class="slide level2">
<h2>Other methods</h2>
<p>Graham (2003) and the textbook also briefly consider:</p>
<ul>
<li>Residual and sequential regression</li>
<li>Principal component regression</li>
<li>Structural equation models (related to causal inference methods in Ch 7)</li>
</ul>
</section>
<section id="colin" class="slide level2" data-menu-title="Kelp data" style="font-size: 80%;">
<h2></h2>
<p>Example from Graham (2003):</p>
<ul>
<li>OD = wave orbital displacement (in meters)</li>
<li>BD = wave breaking depth (in meters)</li>
<li>LTD = average tidal height (in meters)</li>
<li>W = wind velocity (in meters/s).</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(car)</span>
<span id="cb1-2"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">vif</span>(<span class="fu">lm</span>(Response<span class="sc">~</span>OD<span class="sc">+</span>BD<span class="sc">+</span>LTD<span class="sc">+</span>W, <span class="at">data=</span>Kelp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      OD       BD      LTD        W 
2.574934 2.355055 1.175270 2.094319 </code></pre>
</div>
</div>
<div class="fragment">
<p>Always look at the relationship among your predictors (without the response variables) as a first step to assessing collinearity!</p>
</div>
</section>
<section id="colinb" class="slide level2" data-menu-title="Scatterplot matrix">
<h2></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(GGally)</span>
<span id="cb3-2"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggpairs</span>(Kelp[,<span class="fu">c</span>(<span class="st">"OD"</span>, <span class="st">"BD"</span>, <span class="st">"LTD"</span>, <span class="st">"W"</span>)], </span>
<span id="cb3-3"><a href="" aria-hidden="true" tabindex="-1"></a>          <span class="at">lower =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="st">"smooth"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="L06_Multicollinearity_files/figure-revealjs/unnamed-chunk-6-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:70.0%" alt="Scatterplot matrix of predictor variables in the Kelp data set. Lower diagonal contains pairwise scatterplots. Diagonal elements contain a histogram of the data for each variable. Upper diagonals contain pairwise correlations for the different variables."></section>
<section id="residual-and-sequential-regression" class="slide level2" style="font-size: 80%;">
<h2>Residual and sequential regression</h2>
<p>Prioritize different variables to include sequentially:</p>
<ul>
<li>Include <span class="math inline">\(x_1\)</span> (unique and shared contributions)</li>
<li>Then, residuals of lm(<span class="math inline">\(x_2 \sim x_1)\)</span> (part of <span class="math inline">\(x_2\)</span> not shared with <span class="math inline">\(x_1\)</span>)</li>
<li>Then, residuals of lm(<span class="math inline">\(x_3 \sim x_1 + x_2)\)</span> (part of <span class="math inline">\(x_3\)</span> not shared with <span class="math inline">\(x_1\)</span> or <span class="math inline">\(x_2\)</span>)</li>
<li>…</li>
</ul>
<div class="fragment">
<p>How to Prioritize?</p>
<ul>
<li>Instincts and intuition</li>
<li>Previously collected data</li>
</ul>
</div>
</section>
<section id="colinc" class="slide level2" data-menu-title="Sequential LS">
<h2></h2>
<p>Graham considered (newly formed) predictors in this order:</p>
<ul>
<li>OD = captures unique effect of OD + shared effect with other variables</li>
<li>W|OD = captures effect of W not shared with OD</li>
<li>LTD|OD, W = captures effect of LTD that is not shared with OD or W</li>
<li>BD|OD, W, LTD = captures effect of BD not shared with OD, W, LTD</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="" aria-hidden="true" tabindex="-1"></a>  Kelp<span class="sc">$</span>W.g.OD<span class="ot">&lt;-</span><span class="fu">lm</span>(W<span class="sc">~</span>OD, <span class="at">data=</span>Kelp)<span class="sc">$</span>resid</span>
<span id="cb4-2"><a href="" aria-hidden="true" tabindex="-1"></a>  Kelp<span class="sc">$</span>LTD.g.W.OD<span class="ot">&lt;-</span><span class="fu">lm</span>(LTD<span class="sc">~</span>W<span class="sc">+</span>OD, <span class="at">data=</span>Kelp)<span class="sc">$</span>resid  </span>
<span id="cb4-3"><a href="" aria-hidden="true" tabindex="-1"></a>  Kelp<span class="sc">$</span>BD.g.W.OD.LTD<span class="ot">&lt;-</span><span class="fu">lm</span>(BD<span class="sc">~</span>W<span class="sc">+</span>OD<span class="sc">+</span>LTD, <span class="at">data=</span>Kelp)<span class="sc">$</span>resid  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="colincd" class="slide level2" data-menu-title="Sequential fit">
<h2></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="" aria-hidden="true" tabindex="-1"></a>  seq.lm<span class="ot">&lt;-</span><span class="fu">lm</span>(Response<span class="sc">~</span>OD<span class="sc">+</span>W.g.OD<span class="sc">+</span>LTD.g.W.OD<span class="sc">+</span>BD.g.W.OD.LTD, <span class="at">data=</span>Kelp)</span>
<span id="cb5-2"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(seq.lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Response ~ OD + W.g.OD + LTD.g.W.OD + BD.g.W.OD.LTD, 
    data = Kelp)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.284911 -0.098861 -0.002388  0.099031  0.301931 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    2.747588   0.078192  35.139  &lt; 2e-16 ***
OD             0.194243   0.028877   6.726 1.16e-07 ***
W.g.OD         0.008082   0.003953   2.045   0.0489 *  
LTD.g.W.OD    -0.055333   0.141350  -0.391   0.6980    
BD.g.W.OD.LTD -0.004295   0.021137  -0.203   0.8402    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1431 on 33 degrees of freedom
Multiple R-squared:  0.6006,    Adjusted R-squared:  0.5522 
F-statistic: 12.41 on 4 and 33 DF,  p-value: 2.893e-06</code></pre>
</div>
</div>
</section>
<section id="colincde" class="slide level2" data-menu-title="Sequential fit 2">
<h2></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Original model</span></span>
<span id="cb7-2"><a href="" aria-hidden="true" tabindex="-1"></a>seq.lm<span class="ot">&lt;-</span><span class="fu">lm</span>(Response<span class="sc">~</span>OD<span class="sc">+</span>W.g.OD<span class="sc">+</span>LTD.g.W.OD<span class="sc">+</span>BD.g.W.OD.LTD, <span class="at">data=</span>Kelp)</span>
<span id="cb7-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(seq.lm)<span class="sc">$</span>coef  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  Estimate Std. Error    t value     Pr(&gt;|t|)
(Intercept)    2.747587774 0.07819170 35.1391212 1.000393e-27
OD             0.194243475 0.02887749  6.7264678 1.156387e-07
W.g.OD         0.008082141 0.00395292  2.0446003 4.893874e-02
LTD.g.W.OD    -0.055333263 0.14135008 -0.3914626 6.979717e-01
BD.g.W.OD.LTD -0.004294572 0.02113731 -0.2031750 8.402459e-01</code></pre>
</div>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop last two variables</span></span>
<span id="cb9-2"><a href="" aria-hidden="true" tabindex="-1"></a>seq.lm2<span class="ot">&lt;-</span><span class="fu">lm</span>(Response<span class="sc">~</span>OD<span class="sc">+</span>W.g.OD, <span class="at">data=</span>Kelp)</span>
<span id="cb9-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(seq.lm2)<span class="sc">$</span>coef</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               Estimate  Std. Error   t value     Pr(&gt;|t|)
(Intercept) 2.747587774 0.076148241 36.082091 2.796476e-29
OD          0.194243475 0.028122800  6.906975 5.038589e-08
W.g.OD      0.008082141 0.003849614  2.099468 4.305538e-02</code></pre>
</div>
</div>
</div>
</section>
<section id="residual-and-sequential-regression-1" class="slide level2">
<h2>Residual and sequential regression</h2>
<p>Advantages:</p>
<ul>
<li>Unique and shared contributions are represented in the model</li>
<li>Decisions to include or exclude a variable will not depend on what other predictors are included in the model</li>
</ul>
<div class="fragment">
<p>Disadvantages:</p>
<ul>
<li>Requires prioritization (which may not be reflect functional importance of the variables)</li>
</ul>
</div>
</section>
<section id="principal-components-regression" class="slide level2" style="font-size: 80%;">
<h2>Principal Components Regression</h2>
<p>Form new predictors as linear combinations of the correlated variables:</p>
<p><span class="math inline">\(pca_1 = \lambda_{1,1}X_1 + \lambda_{1,2}X_2 + \ldots \lambda_{1,p}x_p\)</span></p>
<p><span class="math inline">\(pca_2 = \lambda_{2,1}X_1 + \lambda_{2,2}X_2 + \ldots \lambda_{2,p}x_p\)</span></p>
<p><span class="math inline">\(\cdots\)</span></p>
<p><span class="math inline">\(pca_p = \lambda_{p,1}X_1 + \lambda_{p,2}X_2 + \ldots \lambda_{p,p}x_p\)</span>, where</p>
<ul>
<li>The <span class="math inline">\(pca_i\)</span>’s are all orthogonal (statistically independent)</li>
<li><span class="math inline">\(pca_1\)</span> accounts for the greatest variation in <span class="math inline">\((x_1, x_2, ..., x_p)\)</span></li>
<li><span class="math inline">\(pca_2\)</span> accounts for greatest amount of remaining variation in <span class="math inline">\((x_1, x_2, ..., x_p)\)</span>, not accounted for by <span class="math inline">\(pca_1\)</span></li>
<li>…</li>
</ul>
</section>
<section id="colincdef" class="slide level2" data-menu-title="PCA">
<h2></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="" aria-hidden="true" tabindex="-1"></a>   pcas<span class="ot">&lt;-</span><span class="fu">prcomp</span>(<span class="sc">~</span>OD<span class="sc">+</span>BD<span class="sc">+</span>LTD<span class="sc">+</span>W, <span class="at">data=</span>Kelp, <span class="at">scale=</span><span class="cn">TRUE</span>)</span>
<span id="cb11-2"><a href="" aria-hidden="true" tabindex="-1"></a>   pcas<span class="sc">$</span>rotation</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           PC1        PC2         PC3         PC4
OD   0.5479919 -0.2901058 -0.15915149 -0.76825404
BD   0.5453470 -0.1793692 -0.58088137  0.57706165
LTD -0.3384653 -0.9335391  0.06706729  0.09720099
W    0.5364166 -0.1103180  0.79545560  0.25949479</code></pre>
</div>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="" aria-hidden="true" tabindex="-1"></a>   <span class="fu">head</span>(<span class="fu">cbind</span>(Kelp[,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>], pcas<span class="sc">$</span>x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      OD   BD   LTD    W         PC1        PC2         PC3         PC4
1 2.0176 4.87 -0.59 -4.1 -0.19127827  1.7527358 -0.66278941  0.24694830
2 1.9553 4.78 -0.75  4.7  0.62234092  2.5023873  0.18091063  0.46900655
3 1.8131 3.14 -0.38 -4.9 -1.33268779  0.9190480 -0.03361542 -0.05590063
4 2.5751 3.28 -0.16 -3.2 -1.08056344 -0.5416139  0.01891911 -0.55322453
5 2.2589 3.28  0.01  5.6 -1.03524778 -1.4381622  1.00570204  0.11858908
6 2.5448 4.87 -0.19  4.1 -0.05452203 -0.6398905  0.18695547  0.22937274</code></pre>
</div>
</div>
</div>
</section>
<section id="biplot" class="slide level2">
<h2>Biplot</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">biplot</span>(pcas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="L06_Multicollinearity_files/figure-revealjs/unnamed-chunk-13-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:75.0%" alt="Bi-plot showing the first two principal components using the Kelp data set, along with the loadings of the original variables. LTD correlates strongly with axis 2 and OD, BD, and W correlate strongly with axis 1."></section>
<section id="principal-components-regression-1" class="slide level2" style="font-size: 80%;">
<h2>Principal Components Regression</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="" aria-hidden="true" tabindex="-1"></a>   <span class="fu">summary</span>(pcas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                          PC1    PC2     PC3     PC4
Standard deviation     1.6017 0.8975 0.60895 0.50822
Proportion of Variance 0.6413 0.2014 0.09271 0.06457
Cumulative Proportion  0.6413 0.8427 0.93543 1.00000</code></pre>
</div>
</div>
<p>The first principal component explains 64% of the variation in (OD, BD, LTD, W)</p>
<div class="fragment">
<p>Choose one or more <span class="math inline">\(pca_i\)</span> to include as new regressors (Graham 2003 suggests including all of them).</p>
<ul>
<li><span class="math inline">\(pca_1\)</span> explains the greatest variation in <span class="math inline">\((x_1, x_2, ..., x_p)\)</span> (not necessarily the greatest variation in <span class="math inline">\(Y\)</span>)</li>
<li>Since the <span class="math inline">\(pca_i\)</span>’s are orthogonal, the coefficients will not change as other <span class="math inline">\(pca_i\)</span>’s are added or dropped.</li>
</ul>
</div>
</section>
<section id="principal-components-regression-2" class="slide level2">
<h2>Principal Components Regression</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="" aria-hidden="true" tabindex="-1"></a>  Kelp<span class="ot">&lt;-</span><span class="fu">cbind</span>(Kelp, pcas<span class="sc">$</span>x)</span>
<span id="cb18-2"><a href="" aria-hidden="true" tabindex="-1"></a>  lm.pca<span class="ot">&lt;-</span><span class="fu">lm</span>(Response<span class="sc">~</span> PC1<span class="sc">+</span>PC2<span class="sc">+</span>PC3<span class="sc">+</span>PC4, <span class="at">data=</span>Kelp)</span>
<span id="cb18-3"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(lm.pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Response ~ PC1 + PC2 + PC3 + PC4, data = Kelp)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.284911 -0.098861 -0.002388  0.099031  0.301931 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  3.24984    0.02321 140.035  &lt; 2e-16 ***
PC1          0.09806    0.01468   6.678 1.33e-07 ***
PC2         -0.02971    0.02620  -1.134    0.265    
PC3          0.03612    0.03862   0.935    0.356    
PC4         -0.07826    0.04628  -1.691    0.100    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1431 on 33 degrees of freedom
Multiple R-squared:  0.6006,    Adjusted R-squared:  0.5522 
F-statistic: 12.41 on 4 and 33 DF,  p-value: 2.893e-06</code></pre>
</div>
</div>
</section>
<section id="principal-components-regression-3" class="slide level2">
<h2>Principal Components Regression</h2>
<p>The main disadvantage is the principal components can be difficult to interpret.</p>
<p>Options:</p>
<ul>
<li>Can apply separately to groups of like variables (“weather”, “vegetation”, etc)</li>
<li>Consider other “rotations” (that ensure that some <span class="math inline">\(\lambda_{i,j} = 0\)</span>)</li>
<li>Other variable clustering methods that group variables (Harrell 2001. Regression Modeling Strategies).</li>
</ul>
</section>
<section id="structural-equation-modeling" class="slide level2">
<h2>Structural Equation Modeling</h2>
<ul>
<li>Chapter on Causal Models (on Moodle)</li>
<li>Allows for direct and indirect effects</li>
<li>Can account for unique and shared contributions (the latter through latent variables)</li>
<li>Focuses on <em>a priori</em> modeling and testing of hypothesized relationships</li>
</ul>
</section>
<section id="conclusions-from-graham-2003" class="slide level2">
<h2>Conclusions from Graham (2003)</h2>
<p>“The suite of techniques described herein compliment each other and offer ecologists useful alternatives to standard multiple regression for identifying ecologically relevant patterns in collinear data. Each comes with its own set of benefits and limitations, yet together they allow ecologists to directly address the nature of shared variance contributions in ecological data.”</p>

</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="L06_Multicollinearity_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="L06_Multicollinearity_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="L06_Multicollinearity_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="L06_Multicollinearity_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="L06_Multicollinearity_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="L06_Multicollinearity_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="L06_Multicollinearity_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="L06_Multicollinearity_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="L06_Multicollinearity_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="L06_Multicollinearity_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="L06_Multicollinearity_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 5.0e-2,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    

    <script>

      // htmlwidgets need to know to resize themselves when slides are shown/hidden.

      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

      // slide changes (different for each slide format).

      (function () {

        // dispatch for htmlwidgets

        function fireSlideEnter() {

          const event = window.document.createEvent("Event");

          event.initEvent("slideenter", true, true);

          window.document.dispatchEvent(event);

        }

    

        function fireSlideChanged(previousSlide, currentSlide) {

          fireSlideEnter();

    

          // dispatch for shiny

          if (window.jQuery) {

            if (previousSlide) {

              window.jQuery(previousSlide).trigger("hidden");

            }

            if (currentSlide) {

              window.jQuery(currentSlide).trigger("shown");

            }

          }

        }

    

        // hookup for slidy

        if (window.w3c_slidy) {

          window.w3c_slidy.add_observer(function (slide_num) {

            // slide_num starts at position 1

            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

          });

        }

    

      })();

    </script>

    

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>