<!DOCTYPE html>
<html lang="en"><head>
<script src="L08_ModelingStrategies_files/libs/clipboard/clipboard.min.js"></script>
<script src="L08_ModelingStrategies_files/libs/quarto-html/tabby.min.js"></script>
<script src="L08_ModelingStrategies_files/libs/quarto-html/popper.min.js"></script>
<script src="L08_ModelingStrategies_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="L08_ModelingStrategies_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="L08_ModelingStrategies_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="L08_ModelingStrategies_files/libs/quarto-html/quarto-syntax-highlighting-07ba0ad10f5680c660e360ac31d2f3b6.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.33">

  <meta name="author" content="FW8051 Statistics for Ecologists">
  <title>Multi-Model Inference</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="L08_ModelingStrategies_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="L08_ModelingStrategies_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="L08_ModelingStrategies_files/libs/revealjs/dist/theme/quarto-27a844e7d43f0d31b27642e48490372a.css">
  <link href="L08_ModelingStrategies_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="L08_ModelingStrategies_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="L08_ModelingStrategies_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="L08_ModelingStrategies_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="L08_ModelingStrategies_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="L08_ModelingStrategies_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Multi-Model Inference</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
FW8051 Statistics for Ecologists 
</div>
</div>
</div>

</section>
<section id="learning-objectives" class="slide level2" style="font-size: 80%;">
<h2>Learning objectives</h2>
<div>
<ol type="1">
<li class="fragment"><p>Gain an appreciation for challenges associated with selecting among competing models and performing multi-model inference.</p></li>
<li class="fragment"><p>Understand common approaches used to select a model (e.g., stepwise selection using p-values, AIC, Adjusted <span class="math inline">\(R^2\)</span>).</p></li>
<li class="fragment"><p>Understand the implications of model selection for statistical inference.</p></li>
<li class="fragment"><p>Gain exposure to alternatives to traditional model selection, including full model inference (df spending), model averaging, and penalized likelihood/regularization techniques.</p></li>
<li class="fragment"><p>Be able to evaluate evaluate model performance using cross-validation and model stability using the bootstrap.</p></li>
<li class="fragment"><p>Be able to choose an appropriate modeling strategy, depending on the goal of the analysis (<em>describe</em>, <em>predict</em>, or <em>infer</em>).</p></li>
</ol>
</div>
</section>
<section id="goals-of-multivariable-regression-modeling" class="slide level2" style="font-size: 80%;">
<h2>Goals of multivariable regression modeling</h2>
<ul>
<li><span style="color:red;">Describe</span>: capture the main features of the data in a parsimonious way; which factors are related to the response variable and how?</li>
</ul>
<div class="fragment">
<ul>
<li><span style="color:red;">Explain</span>: test and compare existing theories about which variables, or combination of variables, are causally related to the response variable. Regression coefficients should ideally capture how each variable affects the response variable.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span style="color:red;">Predict</span>: Use a set of sample data to make predictions about future data. It will be important to consider causality/confounding when making predictions for new populations (e.g., new spatial locations).</li>
</ul>
</div>
</section>
<section id="my-experience" class="slide level2" style="font-size: 80%;">
<h2>My Experience</h2>
<p>Linear Models Mid-term</p>
<ul>
<li>Asked to develop a predictive model of Serum Albumin levels</li>
<li>Given real data set (lots of predictors, missing data, etc)</li>
<li>Given a weekend to complete the analysis and write up our report</li>
</ul>
<div class="fragment">
<p>Goals were largely to demonstrate:</p>
<ul>
<li>Knowledge of linear models (diagnostics, model selection, etc)</li>
<li>Ability to generate reliable inference</li>
</ul>
</div>
</section>
<section id="modstrat" class="slide level2" data-menu-title="My experience" style="font-size: 80%;">
<h2></h2>
<p>Strategy I took:</p>
<ul>
<li><span class="math inline">\(n = 136\)</span> observations, split 80% (training data) and 20% (test data)</li>
</ul>
<div class="fragment">
<ul>
<li>Did lots of stuff w/ the training data
<ul>
<li>Grouped variables into similar categories (e.g., socio-economic status, stature [height, weight, etc], dietary intake variables)<br>
</li>
<li>Examined variables for collinearity and tried to pick the best one in a group using all possible regressions involving the group of variables<br>
</li>
<li>Fit a “best model”, considered diagnostics (normality, constant variance, etc), then looked to see if any important variables were omitted</li>
</ul></li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Used the test data to evaluate predictive ability</li>
</ul>
</div>
</section>
<section id="results" class="slide level2">
<h2>Results</h2>

<img data-src="Graphics/linmods.jpg" class="quarto-figure quarto-figure-center r-stretch" style="width:90.0%" alt="Screenshot of my final exam score and model I used for inference." id="fig-linmod"><p class="caption">
Figure&nbsp;1: My mid-tem exam from my Linear Models class.
</p></section>
<section>
<section id="traditional-approaches-used-to-compare-models" class="title-slide slide level1 center">
<h1>Traditional approaches used to compare models</h1>

</section>
<section id="nested-and-non-nested-models" class="slide level2">
<h2>Nested and Non-nested Models</h2>
<p>Nested = can get from one model to the other by setting one or more parameters = 0.</p>
<ul>
<li><span class="math inline">\(\mbox{Sleep} = \beta_0 + \beta_1\mbox{Danger} + \beta_2\mbox{LifeSpan}\)</span></li>
<li><span class="math inline">\(\mbox{Sleep} = \beta_0 + \beta_1\mbox{Danger}\)</span></li>
</ul>
</section>
<section id="model-comparisons" class="slide level2" style="font-size: 80%;">
<h2>Model comparisons</h2>
<p>We can compare nested models using…</p>
<ul>
<li>p-values from hypothesis tests (nested models only), t-tests, F-tests, likelihood ratio tests</li>
</ul>
<div class="fragment">
<p>And, nested or non-nested models using…</p>
<ul>
<li>Compare adjusted <span class="math inline">\(R^2\)</span> between competing models<br>
</li>
<li>Compare model AIC values = -2*log-likelihood + 2p (nested and non-nested models; smaller is better)</li>
</ul>
</div>
<div class="fragment">
<p>Problem 1: different (arbitrary) criteria often point to different models as “best.”</p>
</div>
<div class="fragment">
<p>Problem 2: the importance of a variable may depend on what else is in the model!</p>
</div>
</section>
<section id="how-do-we-choose-a-best-model" class="slide level2" style="font-size: 80%;">
<h2>How do we choose a best model?</h2>
<p>If we have several potential predictors, how can we decide on a best model?</p>
<div class="fragment">
<ul>
<li>We can compare a list of nested models in a structured way (adding variables or deleting variables using “stepwise selection” procedures)</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>We can compare any list of models (nested or non-nested) using AIC</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>We can “think hard” about the problem and focus on a single most appropriate model (with others models considered as part of a “sensitivity analysis”)</li>
</ul>
</div>
</section></section>
<section>
<section id="modeling-strategies" class="title-slide slide level1 center">
<h1>Modeling Strategies</h1>

</section>
<section id="stepwise-variable-selection" class="slide level2 smaller">
<h2>Stepwise Variable Selection</h2>
<p>One method: Backward Elimination</p>
<ul>
<li>Start with a model with multiple predictors</li>
</ul>
<div class="fragment">
<ul>
<li>Consider all possible models formed by dropping 1 of these predictors</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Keep the current model, or drop the “worst” predictor depending on:
<ul>
<li>p-values from the individual t-tests (drop the variable with the highest p-value, if <span class="math inline">\(&gt;0.05\)</span>)</li>
<li>Adjusted <span class="math inline">\(R^2\)</span> values (higher values are better)<br>
</li>
<li>AIC (lower values are better)</li>
</ul></li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Rinse and repeat until you can no longer improve the model</li>
</ul>
<p>The <code>stepAIC</code> function in the <code>MASS</code> library will do this for us.</p>
</div>
<div class="fragment">
<p>Can also do “forward selection” (or fit all possible models “all subsets”)</p>
</div>
</section>
<section id="change-in-estimate-criterion" class="slide level2">
<h2>Change-in-estimate criterion</h2>
<p>Heinze et al.&nbsp;(2017) suggest using “augmented backwards elimination”</p>
<p>Eliminate variables using significant testing, but only drop a variable if it does not lead to large changes in other regression coefficients.</p>
<p>Available in <code>abe</code> package (I have not used, but am intrigued…)</p>
</section>
<section id="data-driven-inference" class="slide level2">
<h2>Data-Driven Inference</h2>
<p>Problem 4: p-values, confidence intervals, etc assume the model has been pre-specified. Measures of fit, after model selection, will be overly optimistic.</p>
<div class="fragment">
<p><br></p>
<p>Problem 5: no guarantee that the ‘best-fit’ model is actually the most appropriate model for answering your question.</p>
</div>
</section>
<section id="stepwise-selection" class="slide level2" style="font-size: 80%;">
<h2>Stepwise selection</h2>
<p>Harrel et al.&nbsp;2001. Regression Modeling Strategies:</p>
<ol type="1">
<li><span class="math inline">\(R^2\)</span> values are biased high.<br>
</li>
<li>The ordinary F and <span class="math inline">\(\chi^2\)</span> test statistics do not have the claimed distribution<br>
</li>
<li>SEs of regression coefficients will be biased low and confidence intervals will be falsely narrow.<br>
</li>
<li>p-values will be too small and do not have the proper meaning (due to multiple comparison problems).<br>
</li>
<li>Regression coefficients will be biased high in absolute magnitude.<br>
</li>
<li>Rather than solve problems caused by collinearity, variable selection is made arbitrary by collinearity.</li>
<li>It allows us not to think about the problem.</li>
</ol>
</section>
<section id="stepwise-selection-1" class="slide level2" style="font-size: 80%;">
<h2>Stepwise Selection</h2>
<p>Copas and Long,” the choice of the variables to be included depends on estimated regression coefficients rather than their true values, and so <span class="math inline">\(X_j\)</span> is more likely to be included if its regression coefficient is over-estimated than if its regression coefficient is underestimated.”</p>
<div class="fragment">
<p><br></p>
<p>Stepwise methods often select noise variables rather than ones that are truly important.</p>
</div>
<div class="fragment">
<p><br></p>
<p>Problems get worse as you consider more candidate predictors and as these predictors become more highly correlated.</p>
</div>
</section>
<section id="regression-modeling-strategies-frank-harrells-book" class="slide level2">
<h2>Regression Modeling Strategies (Frank Harrell’s book)</h2>
<p>Why do variable selection?</p>
<div class="fragment">
<ul>
<li>Desire to find a ‘concise’ model<br>
</li>
<li>Fear of collinearity influencing results<br>
</li>
<li>False belief that it is not legitimate to include ‘insignificant’ regression coefficients.<br>
</li>
<li>May increase precision by dropping unimportant variables.</li>
</ul>
</div>
</section>
<section id="df-spending" class="slide level2" style="font-size: 80%;">
<h2>df spending</h2>
<p>Often sensible to determine how many ‘degrees of freedom’ you can spend, spend them, and then don’t look back.</p>
<ul>
<li>limit model df (number of parameters) to <span class="math inline">\(\le n/10\)</span> or <span class="math inline">\(\le n/20\)</span>, where <span class="math inline">\(n\)</span> is your effective sample size (Harrell 2001. Regression Modeling Strategies).<br>
</li>
<li>said another way, require 10-20 “events” per variable</li>
<li>fit a “full model” without further simplification.</li>
</ul>
<div class="fragment">
<p>Increases the chance that the model will fit future data nearly as well as the current data set (versus <em>overfitting</em> current data)</p>
</div>
</section>
<section id="effective-sample-size" class="slide level2">
<h2>Effective sample size</h2>

<img data-src="Graphics/harrell.jpg" class="quarto-figure quarto-figure-center r-stretch" style="width:90.0%" alt="Table from Frank Harrel's book with different effective sample sizes for different types of variables."></section>
<section id="how-to-choose-predictors" class="slide level2" style="font-size: 80%;">
<h2>How to choose predictors</h2>
<ul>
<li>Subject matter knowledge</li>
<li>Cost/feasibility of data collection</li>
<li>Relevance to your research questions</li>
<li>Potential to be a confounding variable</li>
</ul>
<div class="fragment">
<ul>
<li>Degree of missingness</li>
<li>Correlation with one or more other variables</li>
<li>Degree of variability (may want to combine rare categories)</li>
</ul>
</div>
</section>
<section id="boostrapping-to-evaluate-model-stability" class="slide level2" style="font-size: 80%;">
<h2>Boostrapping to Evaluate Model stability</h2>
<p>How likely are you to end up with the same model if you collect another data set of the same size and apply the same model selection algorithm.</p>
<ul>
<li><p>can report bootstrap inclusion frequencies (how often variables are selected in final models)</p></li>
<li><p>may want to also report “competitive models” (others that are frequently chosen)</p></li>
<li><p>don’t trust a single model unless it is almost always chosen</p></li>
</ul>
<div class="fragment">
<p>Can also use the bootstrap to get a more honest measure of fit.</p>
<!---
##  {style="font-size: 80%;"}

 
See: Figure 1, Fieberg and Johnson (2015)

1. Estimate regression parameters using the full data set.  
2. Form bootstrapped test and bootstrapped training data sets by resampling the original data set with replacement  
3. Fit the full model to the bootstrapped training data set  
4. Use the model from step 3 to form predicted responses for the bootstrapped test data set.  
5. Fit a linear regression model using the test data responses (as the response variable) and the predicted values from step 4 as the only explanatory variable  
6. Repeat steps 2-5 many times.  The average slope in step 5 can be used to proportionally reduce, or shrink, the regression parameters from step 1 towards 0; if no overfitting has occurred, the average slope in step 5 will be 1.   


 

## Regression Modeling Strategies (rms)

R package: `rms` has functions for implementing bootstrap-based model validation/calibration: 

- linear regression models (using `ols` rather than `lm`)
- generalized least squares (using `Gls` rather than `gls`)
- logistic regression models (using `lrm` rather than `glm`)
- cox proportional hazards models (using `cpm` rather than `cph`)

and a few others...but not mixed models. 
...


See in-class example for a demonstration and paper by Heinze et al. (2017) on Canvas for further discussion.
--->
</div>
</section>
<section id="aic-and-model-averaging" class="slide level2 smaller">
<h2>AIC and model-averaging</h2>
<p>Rather than choose a <em>best</em> model, another approach is to average predictions among “competitive” models or models with roughly equal “support”.</p>
<p>Steps:</p>
<div>
<ol type="1">
<li class="fragment">Start by writing down <span class="math inline">\(K\)</span> biologically plausible models.</li>
<li class="fragment">Fit these models and calculate <span class="math inline">\(AIC\)</span> (trades-offs goodness-of-fit and model complexity)</li>
<li class="fragment">Compute model weights, using the <span class="math inline">\(AIC\)</span> values, reflecting “relative plausibility” of the different models.</li>
</ol>
</div>
<div class="fragment">
<p><span class="math display">\[w_i= \frac{\exp(-\Delta AIC_i)}{\sum_{k=1}^K\exp(-\Delta AIC_k)}\]</span></p>
<p>where <span class="math inline">\(\Delta AIC_i\)</span> = <span class="math inline">\(min_k(AIC_k) - AIC_i\)</span> (difference in AIC between the “best” model and model <span class="math inline">\(i\)</span>)</p>
</div>
<div class="fragment">
<ol start="4" type="1">
<li>Calculate weighted predictions and SEs that account for model uncertainty.</li>
</ol>
</div>
</section>
<section id="model-averaging" class="slide level2" style="font-size: 80%;">
<h2>Model Averaging</h2>
<p>Use <span class="math inline">\(AIC\)</span> weights to calculate a weighted average prediction:</p>
<p><span class="math display">\[\hat{\theta}_{avg}=\sum_{k=1}^K w_k\hat{\theta}_k\]</span></p>
<div class="fragment">
<p>Calculate a standard error that accounts for model uncertainty and sampling uncertainty:</p>
<p><span class="math display">\[\widehat{SE}_{avg} = \sum_{k=1}^K w_k\sqrt{SE^2(\hat{\theta}_k)+ (\hat{\theta}_k-\hat{\theta}_{avg})^2}\]</span></p>
</div>
<div class="fragment">
<p>Typically, 95% CIs are formed using <span class="math inline">\(\hat{\theta}_{avg} \pm 1.96\widehat{SE}_{avg}\)</span>, assuming that <span class="math inline">\(\hat{\theta}_{avg}\)</span> is normally distributed.</p>
</div>
</section>
<section id="references" class="slide level2" style="font-size: 80%;">
<h2>References</h2>
<p>Burnham, Kenneth P., and David R. Anderson. Model selection and multimodel inference: a practical information-theoretic approach. Springer, 2002.</p>

<img data-src="Graphics/Ken.png" class="quarto-figure quarto-figure-center r-stretch" style="width:80.0%" alt="Picture of Ken Burnhams google scholar page, showing 50113 citations for his book."><div class="fragment">
<p>For a counter-point, see (optional reading on Canvas):</p>
<p>Cade, B. S. (2015). Model averaging and muddled multimodel inferences. Ecology, 96(9), 2370-2382.</p>
<p>And, <a href="https://www.youtube.com/watch?v=lEDpZmq5rBw">Mark Brewer’s talk on the Cult of AIC</a></p>
<!---
## Summary

Presented several modeling strategies

1. Full model (df spending) - avoids model selection 
2. Backwards elimination/stepwise selection (possibly with change-in-estimate criterion)
3. Model averaging (using multiple models for inference) 
...


It can be useful to explore the effect of model selection using simulations and bootstrapping.

## Advantages and Disadvantages

"Some thoughts regarding adv and disadv of different modeling strategies.pdf"

under \textbf{Additional Resources} on Canvas \textit{Model comparisons and averaging; Multicollinearity; Causal Networks} tab  
--->
<!---

## Sleep


\begin{center}
\includegraphics[width=4 in]{../graphics/sleepg}
\end{center}

##  Sleep and Mammals

Sleep is characterized by either slow wave (non-dreaming) or rapid eye movement (dreaming), with wide variability in the amount of both types of sleep.

- Roe Deer sleep < 3 hours/day
- Little Brown bat sleeps close to 20 hours per day

Why?  What is the purpose of sleep?

- Memory consolidation
- Energy conservation


\footnotesize Allison, Truett and Cicchetti, Domenic V. (1976), Sleep  in  Mammals: 
Ecological and Constitutional  Correlates,  Science,  November  12, 
vol. 194, pp. 732-734.

\note{V. M. Savage and G. B. West. A quantitative, theoretical framework for understanding mammalian sleep. Proceedings of the National Academy of Sciences, 104 (3):1051-1056, 2007.} 

## Variables
 
- Lifespan (years)
- Gestation (days)
- log(Brain weight) (g)
- log(Body Weight) (kg)
- Predation Index (1-5; 1 = least likely to be preyed upon)
- Exposure Index [1-5: 1 = least exposed (e.g., animal sleeps in a den)]
- Danger Index (1:5, combines exposure and predation; 1= least danger from other animals)

Any guesses which are most highly associated with total sleep?

## Correlations



::: {.cell layout-align="center"}

:::


\begin{table}[ht]
\centering
\begin{tabular}{rr}
  \hline
 & correlation \\ 
  \hline
LifeSpan & -0.40 \\ 
  Gestation & -0.63 \\ 
  Predation & -0.46 \\ 
  Exposure & -0.67 \\ 
  Danger & -0.64 \\ 
  log.BodyWt & -0.61 \\ 
  log.BrainWt & -0.62 \\ 
   \hline
\end{tabular}
\end{table} 

\note{Danger is an index based on exposure index and predation risk indices.}
 
## Sleep and LifeSpan




::: {.cell layout-align="center"}

```{.r .cell-code}
lm.fit<-lm(TotalSleep~LifeSpan, data=sleep)
summary(lm.fit)
```

::: {.cell-output .cell-output-stdout}

```

Call:
lm(formula = TotalSleep ~ LifeSpan, data = sleep)

Residuals:
   Min     1Q Median     3Q    Max 
-6.787 -3.355 -0.048  2.345  9.669 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 12.36521    0.94603  13.071 5.05e-16 ***
LifeSpan    -0.08891    0.03396  -2.618   0.0124 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.405 on 40 degrees of freedom
Multiple R-squared:  0.1463,    Adjusted R-squared:  0.1249 
F-statistic: 6.853 on 1 and 40 DF,  p-value: 0.01243
```


:::
:::




## 



::: {.cell layout-align="center"}

```{.r .cell-code}
lm.fit3<-lm(TotalSleep~LifeSpan + Danger + log.BrainWt, data=sleep)
summary(lm.fit3)
```

::: {.cell-output .cell-output-stdout}

```

Call:
lm(formula = TotalSleep ~ LifeSpan + Danger + log.BrainWt, data = sleep)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.3362 -1.9669 -0.1445  2.3394  5.1498 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept) 17.526087   1.167142  15.016  < 2e-16 ***
LifeSpan    -0.008602   0.037597  -0.229 0.820260    
Danger      -1.602231   0.387787  -4.132 0.000191 ***
log.BrainWt -0.864053   0.316957  -2.726 0.009640 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.148 on 38 degrees of freedom
Multiple R-squared:  0.5858,    Adjusted R-squared:  0.5531 
F-statistic: 17.91 on 3 and 38 DF,  p-value: 2.085e-07
```


:::
:::



## LifeSpan? {Think-Pair-Share}

One predictor model:
\begin{table}[ht]
\centering
\begin{tabular}{rrrrr}
  \hline
 & Estimate & Std. Error & t value & Pr($>$$|$t$|$) \\ 
  \hline
(Intercept) & 12.3652 & 0.9460 & 13.07 & 0.0000 \\ 
  LifeSpan & -0.0889 & 0.0340 & -2.62 & 0.0124 \\ 
   \hline
\end{tabular}
\end{table}

3 Predictor Model:
\begin{table}[ht]
\centering
\begin{tabular}{rrrrr}
  \hline
 & Estimate & Std. Error & t value & Pr($>$$|$t$|$) \\ 
  \hline
(Intercept) & 17.5261 & 1.1671 & 15.02 & 0.0000 \\ 
  LifeSpan & -0.0086 & 0.0376 & -0.23 & 0.8203 \\ 
  Danger & -1.6022 & 0.3878 & -4.13 & 0.0002 \\ 
  log.BrainWt & -0.8641 & 0.3170 & -2.73 & 0.0096 \\ 
   \hline
\end{tabular}
\end{table}


...


Individual t-tests assess the importance of a predictor **after** the other predictors are already in the model.

## Collinearity

After accounting for Brain Weight, lifespan is no longer a significant predictor.



::: {.cell layout-align="center"}

```{.r .cell-code}
cor(LifeSpan~log.BrainWt, data=sleep)
```

::: {.cell-output .cell-output-stdout}

```
[1] 0.7358429
```


:::
:::



Lifespan and brain weight are highly correlated $\Rightarrow$ they will ``compete'' to explain the same variability in sleep measurements. 
...


After adjusting for log.BrainWt, the effect of Lifespan is no longer significant.


## $R^2$ for choosing a model 


$R^2$ = amount of variability in $Y$ that is explained by a model. 
...


You can always increase $R^2$ by adding more predictors (you can't explain *less* variability!).
...
 
 
[Adjusted $R^2$]{style="color:red;"} is like $R^2$, but takes into account the number of explanatory variables (k)

The adjusted R-squared increases only if the new term improves the model more than expected by chance when adding a non-important predictor.


## $R^2$ versus adjusted $R^2$
  


```
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  17.4416     1.0937  15.948  < 2e-16  
Danger       -1.5755     0.3652  -4.314 0.000106  
log.BrainWt  -0.9194     0.2021  -4.548 5.15e-05  
 
Residual standard error: 3.11 on 39 degrees of freedom
Multiple R-squared:  0.5852, Adjusted R-squared:  0.5639
```


```
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 17.526087   1.167142  15.016  < 2e-16  
Danger      -1.602231   0.387787  -4.132 0.000191  
log.BrainWt -0.864053   0.316957  -2.726 0.009640  
LifeSpan    -0.008602   0.037597  -0.229 0.820260    

Residual standard error: 3.148 on 38 degrees of freedom
Multiple R-squared:  0.5858,  Adjusted R-squared:  0.5531
```
--->

</div>
</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="L08_ModelingStrategies_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="L08_ModelingStrategies_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="L08_ModelingStrategies_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="L08_ModelingStrategies_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="L08_ModelingStrategies_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="L08_ModelingStrategies_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="L08_ModelingStrategies_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="L08_ModelingStrategies_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="L08_ModelingStrategies_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="L08_ModelingStrategies_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="L08_ModelingStrategies_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 5.0e-2,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    

    <script>

      // htmlwidgets need to know to resize themselves when slides are shown/hidden.

      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

      // slide changes (different for each slide format).

      (function () {

        // dispatch for htmlwidgets

        function fireSlideEnter() {

          const event = window.document.createEvent("Event");

          event.initEvent("slideenter", true, true);

          window.document.dispatchEvent(event);

        }

    

        function fireSlideChanged(previousSlide, currentSlide) {

          fireSlideEnter();

    

          // dispatch for shiny

          if (window.jQuery) {

            if (previousSlide) {

              window.jQuery(previousSlide).trigger("hidden");

            }

            if (currentSlide) {

              window.jQuery(currentSlide).trigger("shown");

            }

          }

        }

    

        // hookup for slidy

        if (window.w3c_slidy) {

          window.w3c_slidy.add_observer(function (slide_num) {

            // slide_num starts at position 1

            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

          });

        }

    

      })();

    </script>

    

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>